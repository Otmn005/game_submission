<!doctype html>
<html lang="en">
<head>
  <!--
    RMIT GenAI & Cybersecurity Hackathon 2025 â€” Challenge 3
    Campus: RMIT City â€¢ Team: The Trinity
    Game: UniLife Simulator â€” BitLife-style narrative sim (AU context)
    Focus: Mental-Health Resilience and Decision-Making for Students
    Tech: Pure HTML/CSS/JS (front-end only)
  -->
  <meta charset="utf-8" />
  <title>UniLife Simulator â€” RMIT City</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg1:#eaf7f4; --bg2:#eaf2fb; --panel:#ffffff; --ink:#0a2a2e; --muted:#486e73;
      --accent:#2bb6f6; --accent2:#69e6b8; --stroke:#d8e5ec; --shadow:0 8px 26px rgba(9,30,66,.15);
      --good:#16a34a; --bad:#ef4444; --warn:#f59e0b;
      --barBG:#eef6fb; --barGrad:linear-gradient(90deg,#8ee3ff,#b9fbd6);
    }
    *{box-sizing:border-box}
    body{
      margin:0; color:var(--ink); font-family:Inter,system-ui,Segoe UI,Arial,sans-serif;
      background:linear-gradient(180deg,var(--bg1),var(--bg2) 60%, #f7fbff);
    }
    .wrap{max-width:1100px;margin:0 auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
    h1{margin:0;font-size:28px;line-height:1.1}
    .pill{font-size:12px;padding:4px 10px;border-radius:999px;border:1px solid var(--stroke);background:rgba(255,255,255,.9)}
    .card{background:var(--panel);border:1px solid var(--stroke);border-radius:16px;box-shadow:var(--shadow)}
    .panel{padding:18px}
    .row{display:flex;gap:16px;flex-wrap:wrap}
    .btn{border:1px solid var(--stroke);background:#f7fbff;color:var(--ink);padding:10px 14px;border-radius:12px;cursor:pointer}
    .btn:hover{border-color:var(--accent)}
    .btn.primary{background:linear-gradient(135deg,#8ee3ff,#b9fbd6);color:#05292f;border:none}
    .btn.ghost{background:transparent}
    .muted{color:var(--muted)}
    footer{margin-top:12px;color:#5a7f85;font-size:12px;text-align:center}

    /* Stats HUD */
    .hud{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .stat{background:#f7fbff;border:1px solid var(--stroke);padding:10px 12px;border-radius:12px;display:flex;gap:10px;align-items:center}
    .bar{width:160px;height:10px;background:var(--barBG);border-radius:999px;overflow:hidden;border:1px solid var(--stroke)}
    .bar>span{display:block;height:100%;background:var(--barGrad);transition:width .25s ease}
    .week-pill{padding:6px 10px;border-radius:10px;border:1px solid var(--stroke);background:#fff}

    /* Legend + Objective */
    .legend, .objective {
      background:#f7fbff;border:1px solid var(--stroke);border-radius:12px;padding:10px 12px;font-size:13px;
    }
    .legend span{display:inline-block;margin-right:10px}
    .objective b{color:var(--accent2)}

    /* Log */
    .log{height:240px;overflow:auto;background:#f7fbff;border:1px solid var(--stroke);border-radius:12px;padding:10px;font-size:14px;color:#335b60}
    .log p{margin:6px 0}

    /* Choices */
    .choices{display:grid;grid-template-columns:1fr;gap:10px}
    .choice-btn{display:flex;justify-content:space-between;align-items:center}
    .delta{font-size:12px;font-weight:600}
    .pos{color:var(--good)}
    .neg{color:var(--bad)}

    #confettiCanvas{position:fixed;inset:0;pointer-events:none;display:none;z-index:999}
    .two-col{display:grid;grid-template-columns:1.2fr .8fr;gap:16px}
    @media (max-width:900px){ .two-col{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <canvas id="confettiCanvas"></canvas>
  <div class="wrap">
    <header>
      <h1>UniLife Simulator â€” RMIT City</h1>
      <div><span class="pill">Mental Health Focus</span><span class="pill">Front-end Only</span></div>
    </header>

    <!-- MENU -->
    <div id="view-menu" class="card panel">
      <div class="two-col">
        <div>
          <h2>Start your semester</h2>
          <p class="muted">Balance <b>Wellbeing</b>, <b>Knowledge</b>, <b>Money</b>, and <b>Social</b> over 15 weeks. Your goal: stay healthy while passing your courses.</p>
          <label>Display Name<br><input id="char-name" placeholder="e.g., Alex" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--stroke)"></label>
          <label>Major<br><select id="char-major" style="width:100%;padding:10px;border-radius:10px;border:1px solid var(--stroke)">
            <option value="General">General Studies</option>
            <option value="Engineering">Engineering (knowledge+, wellbeing-)</option>
            <option value="Health">Health Sciences (wellbeing+, money-)</option>
            <option value="Business">Business (money+, social+)</option>
          </select></label>
          <button class="btn primary" id="btn-start">Start Semester</button>
          <button class="btn" id="btn-continue">Continue</button>
        </div>
        <div class="card panel">
          <h3>How it works</h3>
          <ul class="muted">
            <li>Each turn = 1 week</li>
            <li>Pick from 3â€“4 choices per event</li>
            <li>Stats affect endings</li>
            <li>Stay balanced for success ðŸŽ“</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- PLAY -->
    <div id="view-play" class="card panel" style="display:none">
      <div class="row" style="align-items:flex-start;flex-wrap:wrap;">
        <div style="flex:1 1 560px">
          <div class="hud">
            <div class="week-pill">Week <span id="week-num">1</span>/15</div>
            <div class="stat">WB<div class="bar"><span id="wb-bar" style="width:70%"></span></div><span id="wb-num">70</span></div>
            <div class="stat">KN<div class="bar"><span id="kn-bar" style="width:40%"></span></div><span id="kn-num">40</span></div>
            <div class="stat">$ <div class="bar"><span id="mo-bar" style="width:50%"></span></div><span id="mo-num">50</span></div>
            <div class="stat">SO<div class="bar"><span id="so-bar" style="width:40%"></span></div><span id="so-num">40</span></div>
            <button class="btn" id="btn-save">ðŸ’¾ Save</button>
          </div>

          <div class="legend" style="margin-top:10px;">
            <b>Legend:</b>
            <span>WB = Wellbeing</span>
            <span>KN = Knowledge</span>
            <span>$ = Money</span>
            <span>SO = Social</span>
          </div>

          <div id="event-card" class="card panel" style="background:#f7fbff;margin-top:12px">
            <h3 id="ev-title">Welcome to Week 1</h3>
            <p id="ev-text" class="muted">Make a choice to set your rhythm.</p>
            <div class="choices" id="ev-choices"></div>
            <p id="ev-tip" class="muted"></p>
          </div>

          <div class="objective" style="margin-top:12px;">
            ðŸŽ¯ <b>Objective:</b> Maintain balance. Avoid burnout, keep your wellbeing â‰¥ 60 while building knowledge for finals.
          </div>
        </div>

        <div class="card panel" style="flex:1 1 320px;min-width:260px;">
          <h3>Log</h3>
          <div id="log" class="log" aria-live="polite"></div>
        </div>
      </div>
    </div>

    <!-- RESULTS -->
    <div id="view-results" class="card panel" style="display:none">
      <h2 id="result-title">Semester Summary</h2>
      <p id="result-body" class="muted"></p>
      <div class="legend" style="margin-top:10px;">
        <b>Final Stats:</b> <span id="final-wb"></span> WB, <span id="final-kn"></span> KN, <span id="final-mo"></span> $, <span id="final-so"></span> SO
      </div>
      <div class="objective" style="margin-top:10px;">Remember: grades matter, but health matters more ðŸ’š</div>
      <button class="btn primary" id="btn-restart">Play Again</button>
      <button class="btn ghost" id="btn-menu">Main Menu</button>
    </div>

    <footer>Â© 2025 UniLife Simulator â€¢ RMIT City â€” The Trinity</footer>
  </div>

  <script>
    const Sound = (()=> {
      const ctx = window.AudioContext ? new AudioContext() : null;
      function beep({freq=440,dur=0.1,type='sine',vol=0.03}){
        if(!ctx) return;
        const o=ctx.createOscillator(), g=ctx.createGain();
        o.type=type; o.frequency.value=freq; g.gain.value=vol;
        o.connect(g).connect(ctx.destination); o.start();
        g.gain.exponentialRampToValueAtTime(0.0001,ctx.currentTime+dur);
        o.stop(ctx.currentTime+dur+0.02);
      }
      return { good:()=>beep({freq:700,type:'triangle'}), bad:()=>beep({freq:300,type:'sawtooth'}), click:()=>beep({freq:600}) };
    })();

    const Confetti = (()=>{const c=document.getElementById('confettiCanvas'),x=c.getContext('2d');
      let p=[];function resize(){c.width=innerWidth;c.height=innerHeight}addEventListener('resize',resize);resize();
      function burst(n=150){p=[];for(let i=0;i<n;i++)p.push({x:innerWidth/2,y:innerHeight/3,vx:(Math.random()-.5)*6,vy:(Math.random()-.8)*6-2,s:4+Math.random()*4,a:1,c:`hsl(${Math.random()*360},80%,70%)`});
        c.style.display='block';loop();setTimeout(()=>c.style.display='none',2500)}
      function loop(){x.clearRect(0,0,c.width,c.height);p.forEach(o=>{o.vy+=.15;o.x+=o.vx;o.y+=o.vy;o.a*=.98;x.globalAlpha=o.a;x.fillStyle=o.c;x.fillRect(o.x,o.y,o.s,o.s)});if(p[0])requestAnimationFrame(loop)}
      return {burst};
    })();

    const MAX_WEEKS=15,SAVE_KEY='unilife_save';
    const state={name:'',major:'General',week:1,wb:70,kn:40,mo:50,so:40};

    const $=sel=>document.querySelector(sel);
    const bars={wb:$('#wb-bar'),kn:$('#kn-bar'),mo:$('#mo-bar'),so:$('#so-bar')};

    function clamp(v,min,max){return Math.max(min,Math.min(max,v))}
    function updateHUD(){['wb','kn','mo','so'].forEach(k=>{bars[k].style.width=clamp(state[k],0,100)+'%';$('#'+k+'-num').textContent=state[k]})}
    function show(v){['menu','play','results'].forEach(id=>$('#view-'+id).style.display=(id===v?'block':'none'))}
    function log(msg){const p=document.createElement('p');p.innerHTML=msg;$('#log').prepend(p)}

    const EVENTS=[{title:"Study group or solo?",
      text:"How do you prep for the upcoming quiz?",
      options:[
        {label:"Group study",delta:{wb:+2,kn:+4,mo:0,so:+3},tip:"Peers help understanding."},
        {label:"Solo grind",delta:{wb:-3,kn:+6,mo:0,so:-1},tip:"Focus high, stress high."},
        {label:"Skip study",delta:{wb:+1,kn:-4,mo:0,so:+2},tip:"Short rest, poor grades."}
      ]},
      {title:"Late shift offer",text:"Boss offers an extra 5-hour shift tonight.",
      options:[
        {label:"Accept for cash",delta:{wb:-5,kn:0,mo:+8,so:-1},tip:"Fatigue tradeoff."},
        {label:"Decline politely",delta:{wb:+3,kn:+1,mo:0,so:0},tip:"Boundaries matter."},
        {label:"Ask to reschedule",delta:{wb:+2,kn:+2,mo:+3,so:0},tip:"Negotiation skills win."}
      ]}
    ];

    function randomEvent(){return EVENTS[Math.floor(Math.random()*EVENTS.length)]}
    function colorizeDelta(v){const cls=v>=0?'pos':'neg';return `<span class="${cls}">${v>=0?'+':''}${v}</span>`}
    function renderEvent(e){
      $('#ev-title').textContent=e.title;$('#ev-text').textContent=e.text;
      const c=$('#ev-choices');c.innerHTML='';
      e.options.forEach(opt=>{
        const b=document.createElement('button');b.className='btn choice-btn';
        b.innerHTML=`<span>${opt.label}</span><span class="delta">WB ${colorizeDelta(opt.delta.wb)} â€¢ KN ${colorizeDelta(opt.delta.kn)} â€¢ $ ${colorizeDelta(opt.delta.mo)} â€¢ SO ${colorizeDelta(opt.delta.so)}</span>`;
        b.onclick=()=>applyChoice(opt);c.appendChild(b);
      });
      $('#ev-tip').textContent='';
    }
    function applyChoice(opt){
      Object.entries(opt.delta).forEach(([k,v])=>state[k]=clamp(state[k]+v,0,100));
      updateHUD();
      log(`${opt.label} â†’ WB ${colorizeDelta(opt.delta.wb)} â€¢ KN ${colorizeDelta(opt.delta.kn)} â€¢ $ ${colorizeDelta(opt.delta.mo)} â€¢ SO ${colorizeDelta(opt.delta.so)}`);
      $('#ev-tip').textContent='Tip: '+opt.tip;
      if(Object.values(opt.delta).reduce((a,b)=>a+b,0)>=0)Sound.good();else Sound.bad();
      state.week>=MAX_WEEKS?endGame():(state.week++,updateHUD(),renderEvent(randomEvent()),saveLocal());
    }

    function endGame(){
      show('results');
      ['wb','kn','mo','so'].forEach(k=>$('#final-'+k).textContent=state[k]);
      let msg='';if(state.wb>=60&&state.kn>=60)msg='Balanced Success ðŸŽ“ â€” great semester!';
      else if(state.wb<40)msg='Burnout Warning ðŸ˜µ â€” health dropped too low.';
      else msg='Solid Pass âœ… â€” room to improve.';
      $('#result-title').textContent=msg;
      $('#result-body').textContent=`Final Wellbeing ${state.wb}, Knowledge ${state.kn}, Money ${state.mo}, Social ${state.so}.`;
      Confetti.burst();localStorage.removeItem(SAVE_KEY);
    }

    function saveLocal(){localStorage.setItem(SAVE_KEY,JSON.stringify(state))}
    function loadLocal(){try{Object.assign(state,JSON.parse(localStorage.getItem(SAVE_KEY)));return true}catch{return false}}

    $('#btn-start').onclick=()=>{state.name=$('#char-name').value||'Alex';state.major=$('#char-major').value;show('play');renderEvent(randomEvent());updateHUD();saveLocal();}
    $('#btn-continue').onclick=()=>{if(loadLocal()){show('play');renderEvent(randomEvent());updateHUD();}}
    $('#btn-save').onclick=()=>{saveLocal();log('<span class="pos">Progress saved.</span>')}
    $('#btn-restart').onclick=()=>show('menu')
